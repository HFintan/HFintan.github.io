<html>
  <head>
    <title>MSP stuff</title>
  </head>


  <body>
    <h1>What I'm currently working on</h1>
    
    <h2>
Current project: Automate fence sizing.    </h2>
Perl and sed appear unhelpful for seaching and replacing across lines, so I'm going to do this all in the form of a vim macro,
which won't be pretty, so I'll probably stick it in a separate file eventually.<br>
    Anyway, the basic idea is to replace all variants of parentheses with <b>\left(</b> and <b>\right)</b> (which we don't want
    in the finished product) respectively, and then, according
    to their contents, assign them the desired \Bigg, \bigg, \Big, \big, or leave them as ( .<br>
    I've decided to do this only within display mode, for the sake of my sanity. So, the steps are:<br>
    <h4>1. Identify bits in display mode </h4> 
    <h4>2. Reduce all the parens within display mode to <b>\left</b> </h4>
    <h4>3. Make a list of things that need Bigg, bigg, Big, and big parens </h4>
    <h4>4. Search through the displays and find parens and add in Biggs where necessary, then biggs, etc.</h4>
    <h4>5. ????</h4>
    <h4>6. Profit!</h4>
    <br><br>
    <h3> Highlighting bits within math</h3>
    For <b>\begin{align}</b> environments, etc, this should be easy - PROVIDED there are none of these "display-creating" environments
    contained within each other. I think we might be okay on this front - <b>\begin{alignat}</b> and <b>\begin{split}</b> need to
    be within
    display-mode already, and no-one puts a <b>\begin{align}</b> within a <b>\begin{align}</b>. Some of the plain tex stuff, like 
    <b>displaylines</b>
    and <b>eqalign</b> etc do get nested, but again, they need to be placed within math.<br>
    So the tricky display mode is the one which is surrounded simply by <b>$$</b> <b>$$</b>. This is fixable using<br>
    <code>:let a=['$$%FHENDDISPLAY','%FHBEGINDISPLAY$$']^M</code><br>
    <code>\ :%s/\$\$/\=reverse(a)[0]/ge^M</code><br>
    <code>\ :%s/%FHBEGINDISPLAY\$\$/%FHBEGINDISPLAY\r\$\$/ge^M</code><br>
    <code>\ :%s/\$\$%FHENDDISPLAY/\$\$\r%FHENDDISPLAY/ge^M</code><br>
      The first line creates a list whose items we will alternate between (assuming there are no odd <b>$$</b> in a comment somewhere
    - that
    would mess this up royally), and replace <b>$$</b> with. The second two lines are just for breaking these replacements onto
      separate lines for aesthetic and not-effing-everything-up purposes.
    
  </body>
</html>
